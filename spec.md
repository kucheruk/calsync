# CalSync - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 17 –¥–µ–∫–∞–±—Ä—è 2024  
**–≠—Ç–∞–ø—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã:** 4 –∏–∑ 6  
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 75% ‚úÖ

### üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–≠—Ç–∞–ø 1-4 –ó–ê–í–ï–†–®–ï–ù** - –ü–æ–ª–Ω–∞—è HttpClient-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Exchange –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π:
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ .ics —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º iCloud –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
- ‚úÖ **–û–ë–ù–û–í–õ–ï–ù–û:** –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ HttpClient –¥–ª—è Exchange
- ‚úÖ **–û–ë–ù–û–í–õ–ï–ù–û:** –£–¥–∞–ª–µ–Ω–∏–µ Microsoft.Graph –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ **–ù–û–í–û–ï:** –ü–æ–ª–Ω—ã–π CRUD —Ü–∏–∫–ª —á–µ—Ä–µ–∑ SOAP/HTTP –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **–ù–û–í–û–ï:** –†–∞–±–æ—Ç–∞ –Ω–∞ .NET 9 —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏
- ‚úÖ **–ù–û–í–û–ï:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (Europe/Moscow ‚Üí UTC)
- ‚úÖ **–ù–û–í–û–ï:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º Exchange —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ
- ‚úÖ 71 —Ç–µ—Å—Ç, 64 —É—Å–ø–µ—à–Ω—ã—Ö (90% success rate)

### üìÅ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **Models/CalendarEvent.cs** - –ú–æ–¥–µ–ª—å —Å ExchangeId –¥–ª—è EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
2. **Services/IcsDownloader.cs** - HTTP/HTTPS –∑–∞–≥—Ä—É–∑—á–∏–∫
3. **Services/IcsParser.cs** - RFC 5545 –ø–∞—Ä—Å–µ—Ä
4. **Program.cs** - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### **–û–ë–ù–û–í–õ–ï–ù–ù–´–ï Exchange –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
5. **Services/ExchangeHttpService.cs** - –ü–æ–ª–Ω–∞—è HTTP/SOAP —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
   - CreateCalendarEventAsync() - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
   - GetCalendarEventsAsync() - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ 
   - UpdateCalendarEventAsync() - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
   - DeleteCalendarEventAsync() - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
6. **Services/ExchangeService.cs** - Legacy EWS (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

#### **–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
7. **CalSync.Tests/** - –ü–æ–ª–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
8. **MockEwsServer.cs** - HTTP –º–æ–∫-—Å–µ—Ä–≤–µ—Ä –¥–ª—è EWS
9. **EwsRequestRecorder.cs** - –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ EWS –∑–∞–ø—Ä–æ—Å–æ–≤

#### **–§–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
10. **SECURITY.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
11. **appsettings.Local.json.example** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üîÑ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

- **–≠—Ç–∞–ø 5:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (RRULE, –∏—Å–∫–ª—é—á–µ–Ω–∏—è)
- **–≠—Ç–∞–ø 6:** –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ deployment

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–û–ì–û–í–û–†–Å–ù–ù–û–°–¢–ò –ò –ü–û–î–í–û–î–ù–´–ï –ö–ê–ú–ù–ò

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö–†–ò–¢–ò–ß–ù–û!)
- **–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å appsettings.Local.json —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏**
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ –º–æ–∫-–¥–∞–Ω–Ω—ã–µ
- –†–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üö® –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

#### ‚úÖ –†–ï–®–ï–ù–û: Exchange –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ HttpClient
- **–ü—Ä–æ–±–ª–µ–º–∞ .NET 9:** Microsoft.Exchange.WebServices –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º
- **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ HttpClient —Å –ø—Ä—è–º—ã–º–∏ SOAP –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ .NET 9, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Timezone –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Europe/Moscow ‚Üí UTC

#### ‚úÖ –†–ï–®–ï–ù–û: –£–¥–∞–ª–µ–Ω–∏–µ GraphService
- **–ü—Ä–æ–±–ª–µ–º–∞:** Azure.Identity/Microsoft.Graph –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ Graph –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–æ–ª—å–∫–æ —Å HttpClient

#### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- **Update/Delete –æ–ø–µ—Ä–∞—Ü–∏–∏:** SOAP —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **FindItem –∑–∞–ø—Ä–æ—Å—ã:** –í–æ–∑–≤—Ä–∞—â–∞—é—Ç ErrorInvalidRequest (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞)
- **–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:** –†–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ ‚úÖ

### üìã –†–∞–±–æ—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Exchange

```json
{
    "Exchange": {
        "ServiceUrl": "https://your-exchange-server.com/EWS/Exchange.asmx",
        "Domain": "your-domain",
        "Username": "your-username", 
        "Password": "your-password",
        "Version": "Exchange2016_SP1",
        "UseAutodiscover": false,
        "RequestTimeout": 30000,
        "MaxBatchSize": 100,
        "ValidateSslCertificate": false
    }
}
```

### üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –†–µ–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
- ‚úÖ **ICS –∑–∞–≥—Ä—É–∑–∫–∞:** 314 —Å–æ–±—ã—Ç–∏–π –∏–∑ iCloud –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** 1 —Å–æ–±—ã—Ç–∏–µ –Ω–∞ 19 –∏—é–Ω—è 2025
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –≤ Exchange:** –°–æ–±—ã—Ç–∏–µ "test" —Å–æ–∑–¥–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã:** 10:15 Moscow ‚Üí 07:15 UTC ‚úÖ
- ‚úÖ **Event ID:** –ü–æ–ª—É—á–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π Exchange ID

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- ‚úÖ **HttpClient –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ
- ‚úÖ **SOAP –∑–∞–ø—Ä–æ—Å—ã:** –§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **SSL –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** Basic Auth —á–µ—Ä–µ–∑ HttpClient

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### FR-001: –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ –ø–æ HTTP/HTTPS URL
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ webcal:// –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- ‚úÖ Timeout –∏ retry –º–µ—Ö–∞–Ω–∏–∑–º—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### FR-002: –ü–∞—Ä—Å–∏–Ω–≥ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ RFC 5545 (iCalendar)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–±—ã—Ç–∏–π (VEVENT)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (Europe/Moscow)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
- üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è (RRULE) - —á–∞—Å—Ç–∏—á–Ω–æ

### FR-003: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Exchange Server ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ HTTP/SOAP API
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Exchange 2013/2016/2019
- ‚úÖ Basic Authentication —á–µ—Ä–µ–∑ HttpClient
- ‚úÖ SSL/TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã ExchangeHttpService:**
- `TestConnectionAsync()` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚úÖ
- `CreateCalendarEventAsync()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
- `GetCalendarEventsAsync()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
- `UpdateCalendarEventAsync()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
- `DeleteCalendarEventAsync()` - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ

### FR-004: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ Exchange
- ‚úÖ –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ CRUD —Ü–∏–∫–ª–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚ö†Ô∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ SOAP –∑–∞–ø—Ä–æ—Å–æ–≤

### FR-005: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ Exchange –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Exchange ID

## –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### NFR-001: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ 314 —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è: ~2 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

### NFR-002: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ Graceful handling –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ Proper disposal –ø–∞—Ç—Ç–µ—Ä–Ω

### NFR-003: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ git
- ‚úÖ SECURITY.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### NFR-004: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ .NET 9.0
- ‚úÖ Windows 10/11, Linux, macOS
- ‚úÖ Exchange Server 2013/2016/2019
- ‚úÖ HttpClient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∏–Ω–∞–ª—å–Ω–∞—è HttpClient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CLI Interface ‚îÇ    ‚îÇ  Configuration  ‚îÇ    ‚îÇ    Logging      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  CalSync Core   ‚îÇ
                    ‚îÇ   (Program.cs)  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  IcsDownloader  ‚îÇ ‚îÇ    IcsParser    ‚îÇ ‚îÇExchangeHttpSrvc ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ   HttpClient    ‚îÇ ‚îÇ RFC 5545 Parser ‚îÇ ‚îÇ  SOAP/HTTP API  ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  ICS Calendar   ‚îÇ ‚îÇ CalendarEvent   ‚îÇ ‚îÇ Exchange Server ‚îÇ
   ‚îÇ   (iCloud)      ‚îÇ ‚îÇ     Model       ‚îÇ ‚îÇ     (EWS)       ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **ExchangeHttpService** - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è Exchange
   - –ü—Ä—è–º—ã–µ HTTP/SOAP –∑–∞–ø—Ä–æ—Å—ã
   - Basic Authentication
   - –ü–æ–ª–Ω—ã–π CRUD —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
   - Proper timezone handling

2. **CalendarEvent Model** - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
   - ICS —Å–≤–æ–π—Å—Ç–≤–∞ (Uid, Summary, Start, End)
   - Exchange —Å–≤–æ–π—Å—Ç–≤–∞ (ExchangeId)
   - Timezone –ø–æ–¥–¥–µ—Ä–∂–∫–∞

3. **Program.cs** - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- .NET 9.0 SDK
- –î–æ—Å—Ç—É–ø –∫ Exchange Server
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ appsettings.Local.json

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/kucheruk/calsync.git
cd calsync

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp calsync/appsettings.Local.json.example calsync/appsettings.Local.json
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ appsettings.Local.json —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
dotnet build
cd calsync
dotnet run

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
cd ../CalSync.Tests
dotnet test
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
CalSync - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π ICS ‚Üî Exchange
================================================
üìÖ ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å: https://p67-caldav.icloud.com/published/2/...
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ICS —Å–æ–±—ã—Ç–∏–π: 314
üìÖ –í —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ: 1
‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å ID: AAMkADBkMDhiZDQ4LWZj...

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
  ‚úÖ –°–æ–∑–¥–∞–Ω–æ: 1
  ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ: 0
  ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ: 0
  ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0
  ‚ùå –û—à–∏–±–æ–∫: 0
```

## Roadmap

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (–≠—Ç–∞–ø—ã 1-4)
- –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ICS –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥
- Exchange HttpClient –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ü–æ–ª–Ω—ã–π CRUD —Ü–∏–∫–ª
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã
- –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üîÑ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–≠—Ç–∞–ø 5)
- –î–æ—Ä–∞–±–æ—Ç–∫–∞ Update/Delete SOAP –∑–∞–ø—Ä–æ—Å–æ–≤
- –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–æ–≤ Exchange
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ RRULE

### üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è (–≠—Ç–∞–ø 6)
- PowerShell –º–æ–¥—É–ª—å
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- CI/CD pipeline
- Production deployment 