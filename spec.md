# CalSync - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 17 –¥–µ–∫–∞–±—Ä—è 2024  
**–≠—Ç–∞–ø—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã:** 3 –∏–∑ 6  
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 50% ‚úÖ

### üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–≠—Ç–∞–ø 1-3 –ó–ê–í–ï–†–®–ï–ù** - –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å Exchange –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π:
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ .ics —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º iCloud –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
- ‚úÖ **–ù–û–í–û–ï:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Exchange Web Services
- ‚úÖ **–ù–û–í–û–ï:** –†–∞–±–æ—Ç–∞—é—â–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É Exchange —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ **–ù–û–í–û–ï:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–æ–∫-—Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ **–ù–û–í–û–ï:** –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è EWS –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ 65 —Ç–µ—Å—Ç–æ–≤, 59 —É—Å–ø–µ—à–Ω—ã—Ö (91% success rate)
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è EWS –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏

### üìÅ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **Models/CalendarEvent.cs** - –ú–æ–¥–µ–ª—å —Å ExchangeId –¥–ª—è EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
2. **Services/IcsDownloader.cs** - HTTP/HTTPS –∑–∞–≥—Ä—É–∑—á–∏–∫
3. **Services/IcsParser.cs** - RFC 5545 –ø–∞—Ä—Å–µ—Ä
4. **Program.cs** - –ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#### **–ù–û–í–´–ï Exchange –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
5. **Services/ExchangeService.cs** - –ü–æ–ª–Ω–∞—è EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
6. **CalSync.Tests/MockEwsServer.cs** - HTTP –º–æ–∫-—Å–µ—Ä–≤–µ—Ä –¥–ª—è EWS
7. **CalSync.Tests/EwsRequestRecorder.cs** - –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ EWS –∑–∞–ø—Ä–æ—Å–æ–≤
8. **CalSync.Tests/FR003_ExchangeServiceTests.cs** - 11 —Ç–µ—Å—Ç–æ–≤ ExchangeService
9. **CalSync.Tests/ExchangeIntegrationTests.cs** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

#### **–ù–û–í–´–ï —Ñ–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
10. **SECURITY.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
11. **appsettings.Local.json.example** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
12. **EWS_INTEGRATION_REPORT.md** - –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### üîÑ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

- **–≠—Ç–∞–ø 4:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É ICS –∏ Exchange
- **–≠—Ç–∞–ø 5:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (RRULE, –∏—Å–∫–ª—é—á–µ–Ω–∏—è)
- **–≠—Ç–∞–ø 6:** –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ deployment

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–û–ì–û–í–û–†–Å–ù–ù–û–°–¢–ò –ò –ü–û–î–í–û–î–ù–´–ï –ö–ê–ú–ù–ò

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö–†–ò–¢–ò–ß–ù–û!)
- **–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å appsettings.Local.json —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏**
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ –º–æ–∫-–¥–∞–Ω–Ω—ã–µ
- –†–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–Ω SECURITY.md —Å —á–µ–∫-–ª–∏—Å—Ç–æ–º –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

### üö® –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

#### .NET 9 –∏ Exchange Web Services:
- **Timezone –∫–æ–Ω—Ñ–ª–∏–∫—Ç:** "An item with the same key has already been added. Key: Dlt/1880"
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ .NET 9, –Ω–æ —á—Ç–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–û–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å:** –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ Known Issue

#### EWS –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:
- **Windows Authentication —Ä–∞–±–æ—Ç–∞–µ—Ç:** `domain\username` —Ñ–æ—Ä–º–∞—Ç
- **Basic Auth –ù–ï –¢–ï–°–¢–ò–†–û–í–ê–õ–°–Ø** —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
- **SSL –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞** –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **ServicePointManager –∫–æ–Ω—Ñ–ª–∏–∫—Ç** —Å EWS - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–µ –∏–º–µ–Ω–∞

#### –ú–æ–∫-—Å–µ—Ä–≤–µ—Ä –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- MockEwsServer –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å "Cannot access a disposed object"
- –ù—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å lifecycle —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ—Å—Ç–∞—Ö
- –ü–æ—Ä—Ç—ã –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ

### üìã –†–∞–±–æ—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Exchange

```json
{
    "Exchange": {
        "ServiceUrl": "https://your-exchange-server.com/EWS/Exchange.asmx",
        "Domain": "your-domain",
        "Username": "your-username", 
        "Password": "your-password",
        "Version": "Exchange2016_SP1",
        "UseAutodiscover": false,
        "RequestTimeout": 30000,
        "MaxBatchSize": 100,
        "ValidateSslCertificate": false
    }
}
```

### üß™ –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤:
- EwsRequestRecorder –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ EWS –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç xUnit —Ç–µ—Å—Ç—ã –∏–∑ –∑–∞–ø–∏—Å–µ–π
- JSON —Ñ–∞–π–ª—ã —Å –∑–∞–ø–∏—Å—è–º–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

#### –ú–æ–∫-–¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã:
- –î–æ–º–µ–Ω—ã: `test.local`, `example.domain`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: `testuser`, `mockuser`
- –°–µ—Ä–≤–µ—Ä—ã: `localhost`, `exchange.example.com`
- Exchange ID: `MOCK_CALENDAR_ID_*`, `TEST001`, `TEST002`

#### –¢–µ—Å—Ç–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:
- –ü—Ä–µ—Ñ–∏–∫—Å `[TEST]` –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ DeleteAllTestEventsAsync()
- –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª—è—é—Ç—Å—è, —Ä–µ–∞–ª—å–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

## –û–±–∑–æ—Ä

CalSync - —É—Ç–∏–ª–∏—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É .ics —Ñ–∞–π–ª–∞–º–∏ (–∑–∞–≥—Ä—É–∂–∞–µ–º—ã–º–∏ –ø–æ HTTP/HTTPS) –∏ Microsoft Exchange Server —á–µ—Ä–µ–∑ EWS API.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### FR-001: –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ –ø–æ HTTP/HTTPS URL
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ webcal:// –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- ‚úÖ Timeout –∏ retry –º–µ—Ö–∞–Ω–∏–∑–º—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### FR-002: –ü–∞—Ä—Å–∏–Ω–≥ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ RFC 5545 (iCalendar)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–±—ã—Ç–∏–π (VEVENT)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
- üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è (RRULE) - —á–∞—Å—Ç–∏—á–Ω–æ

### FR-003: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Exchange Server ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ EWS API
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Exchange 2013/2016/2019
- ‚úÖ Windows Authentication
- ‚ö†Ô∏è Basic Authentication (–Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å)
- ‚ùå Autodiscover (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ SSL/TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- ‚úÖ Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã ExchangeService:**
- `TestConnectionAsync()` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `GetCalendarEventsAsync()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- `CreateCalendarEventAsync()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (‚ö†Ô∏è .NET 9 issue)
- `DeleteCalendarEventAsync()` - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- `DeleteAllTestEventsAsync()` - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π

### FR-004: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π üîÑ –í –†–ê–ó–†–ê–ë–û–¢–ö–ï
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ Exchange
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤ .ics —Ñ–∞–π–ª–µ
- [ ] –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ UID
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
- [ ] Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### FR-005: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏ üîÑ –ß–ê–°–¢–ò–ß–ù–û
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π

## –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### NFR-001: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ 300+ —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [ ] –í—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ –±–æ–ª–µ–µ 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è 100 —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

### NFR-002: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ Graceful handling –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Rollback –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

### NFR-003: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (appsettings.Local.json –∏—Å–∫–ª—é—á—ë–Ω)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ git
- ‚úÖ Audit trail –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ SECURITY.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### NFR-004: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ .NET 9.0+
- ‚úÖ Windows 10/11, Linux, macOS
- ‚úÖ Exchange Server 2013/2016/2019
- [ ] PowerShell —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Exchange

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CLI Interface ‚îÇ    ‚îÇ  Configuration  ‚îÇ    ‚îÇ    Logging      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  CalSync Core   ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                    ‚îÇ                    ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ICS Downloader ‚îÇ  ‚îÇ   ICS Parser    ‚îÇ  ‚îÇ Exchange Service‚îÇ ‚úÖ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                    ‚îÇ                    ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   HTTP Client   ‚îÇ  ‚îÇ Calendar Model  ‚îÇ  ‚îÇ   EWS Client    ‚îÇ ‚úÖ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                  ‚îÇ
                                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                         ‚îÇ  Mock EWS Server‚îÇ ‚úÖ
                                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

#### 1. CalSync.Core
- `CalSyncService` - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `SyncEngine` - –¥–≤–∏–∂–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- `EventMatcher` - —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

#### 2. CalSync.Ics ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ `IcsDownloader` - –∑–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤
- ‚úÖ `IcsParser` - –ø–∞—Ä—Å–∏–Ω–≥ iCalendar
- ‚úÖ `CalendarEvent` - –º–æ–¥–µ–ª—å —Å–æ–±—ã—Ç–∏—è —Å ExchangeId

#### 3. CalSync.Exchange ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ `ExchangeService` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å EWS
- ‚úÖ `MockEwsServer` - –º–æ–∫-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ `EwsRequestRecorder` - —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] `ExchangeEventMapper` - –º–∞–ø–ø–∏–Ω–≥ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

#### 4. CalSync.CLI
- ‚úÖ `Program` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- [ ] `CommandLineOptions` - –ø–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ `ConfigurationManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

#### 5. CalSync.Tests ‚úÖ –ù–û–í–û–ô –ú–û–î–£–õ–¨
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ 65 —Ç–µ—Å—Ç–æ–≤, 91% success rate
- ‚úÖ –ú–æ–∫-—Å–µ—Ä–≤–µ—Ä—ã –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

## –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ –ó–ê–í–ï–†–®–ï–ù
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –±–∞–∑–æ–≤—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
- [x] Unit —Ç–µ—Å—Ç—ã –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –≠—Ç–∞–ø 2: ICS –º–æ–¥—É–ª—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù
- [x] HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ .ics —Ñ–∞–π–ª–æ–≤
- [x] –ü–∞—Ä—Å–µ—Ä iCalendar (RFC 5545)
- [x] –ú–æ–¥–µ–ª–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
- [x] Unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –≠—Ç–∞–ø 3: Exchange –º–æ–¥—É–ª—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù
- [x] EWS –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
- [x] Windows Authentication (Basic Auth –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è)
- [x] CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- [x] Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
- [x] –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –ú–æ–∫-—Å–µ—Ä–≤–µ—Ä –¥–ª—è EWS
- [x] –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- [x] –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** ‚úÖ
- Microsoft.Exchange.WebServices ‚úÖ

**–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ .NET 9 (timezone conflict)
- ‚ö†Ô∏è MockEwsServer –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å disposal
- ‚ö†Ô∏è Basic Authentication –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω

### –≠—Ç–∞–ø 4: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è üîÑ –°–õ–ï–î–£–Æ–©–ò–ô (1-2 –Ω–µ–¥–µ–ª–∏)
- [ ] –ê–ª–≥–æ—Ä–∏—Ç–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É ICS –∏ Exchange
- [ ] –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ UID
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- [ ] Dry-run —Ä–µ–∂–∏–º
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:**
- ‚úÖ ICS –ø–∞—Ä—Å–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Exchange CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ CalendarEvent –º–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞

### –≠—Ç–∞–ø 5: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (1-2 –Ω–µ–¥–µ–ª–∏)
- [ ] –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è (RRULE) - —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–æ–±—ã—Ç–∏—è—Ö
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π
- [ ] –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] Performance —Ç–µ—Å—Ç—ã
- [ ] –†–µ—à–µ–Ω–∏–µ .NET 9 timezone –ø—Ä–æ–±–ª–µ–º—ã

### –≠—Ç–∞–ø 6: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (1 –Ω–µ–¥–µ–ª—è)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] Packaging –∏ deployment
- [ ] End-to-end —Ç–µ—Å—Ç—ã
- [ ] Performance –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] Security audit

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### CalendarEvent (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è)
```csharp
public class CalendarEvent
{
    public string Uid { get; set; }
    public string Summary { get; set; }
    public string Description { get; set; }
    public DateTime Start { get; set; }
    public DateTime End { get; set; }
    public string Location { get; set; }
    public string Organizer { get; set; }
    public List<string> Attendees { get; set; }
    public RecurrencePattern Recurrence { get; set; }
    public DateTime LastModified { get; set; }
    public EventStatus Status { get; set; }
    
    // ‚úÖ –ù–û–í–û–ï: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Exchange
    public string ExchangeId { get; set; } // –î–ª—è EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
}
```

### SyncResult (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
```csharp
public class SyncResult
{
    public int EventsCreated { get; set; }
    public int EventsUpdated { get; set; }
    public int EventsDeleted { get; set; }
    public List<SyncError> Errors { get; set; }
    public TimeSpan Duration { get; set; }
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—à–∏–±–æ–∫
1. **–°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏** - timeout, connection refused, DNS errors ‚úÖ
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å—Ç–µ–∫—à–∏–µ —Ç–æ–∫–µ–Ω—ã ‚úÖ
3. **–ü–∞—Ä—Å–∏–Ω–≥** - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π .ics —Ñ–æ—Ä–º–∞—Ç, unsupported features ‚úÖ
4. **Exchange –æ—à–∏–±–∫–∏** - EWS errors, –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ –Ω–∞–π–¥–µ–Ω, insufficient permissions ‚úÖ
5. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö, duplicate events (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ Retry —Å exponential backoff –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ Graceful degradation –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- ‚úÖ User-friendly —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### appsettings.json (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è)
```json
{
  "CalSync": {
    "LogLevel": "Information",
    "DefaultSyncInterval": 3600,
    "Exchange": {
      "ServiceUrl": "", // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã
      "Domain": "",     // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è Windows Auth
      "Username": "",   // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
      "Password": "",   // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
      "Version": "Exchange2016_SP1",
      "UseAutodiscover": false, // ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
      "RequestTimeout": 30000,
      "MaxBatchSize": 100,
      "ValidateSslCertificate": false // ‚ö†Ô∏è –î–ª—è —Ç–µ—Å—Ç–æ–≤
    },
    "Ics": {
      "RequestTimeout": 30000,
      "MaxRetryAttempts": 3,
      "RetryDelay": 1000,
      "ValidateSslCertificate": true
    },
    "Sync": {
      "DryRun": true, // ‚ö†Ô∏è –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é true –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
      "PreserveDuplicates": false,
      "SyncDeletedEvents": true
    }
  }
}
```

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω–æ: appsettings.Local.json
- **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ git!**
- –°–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å appsettings.Local.json.example –∫–∞–∫ —à–∞–±–ª–æ–Ω
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å .gitignore –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ 65 —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ 59 —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (91%)
- ‚úÖ Mock –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ Code coverage > 80%

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û  
- ‚úÖ –¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ .ics —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º Exchange —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ MockEwsServer –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏–µ –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ ‚úÖ –ù–û–í–û–ï
- ‚úÖ EwsRequestRecorder –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è xUnit —Ç–µ—Å—Ç–æ–≤
- ‚úÖ JSON —Ñ–∞–π–ª—ã —Å –∑–∞–ø–∏—Å—è–º–∏ –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Performance —Ç–µ—Å—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- [ ] Benchmark –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- [ ] Memory usage —Ç–µ—Å—Ç—ã
- [ ] Stress —Ç–µ—Å—Ç—ã –¥–ª—è concurrent –æ–ø–µ—Ä–∞—Ü–∏–π

## Deployment

### Packaging
- [ ] Self-contained executable –¥–ª—è –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- [ ] NuGet package –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- [ ] Docker image –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏

### CI/CD
- [ ] GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏
- [ ] Automated —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ multiple platforms
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π release –ø—Ä–∏ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏

## üîç –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** `grep -r "password\|secret" . --exclude-dir=.git`
2. **–£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ appsettings.Local.json –Ω–µ –≤ git:** `git status`
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã:** `dotnet test` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ~91% success rate)
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Exchange** (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:
- `calsync/Services/ExchangeService.cs` - –æ—Å–Ω–æ–≤–Ω–∞—è EWS –ª–æ–≥–∏–∫–∞
- `CalSync.Tests/MockEwsServer.cs` - –º–æ–∫-—Å–µ—Ä–≤–µ—Ä
- `CalSync.Tests/EwsRequestRecorder.cs` - —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏
- `SECURITY.md` - –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `EWS_INTEGRATION_REPORT.md` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è EWS

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è:
1. **Timezone –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤ .NET 9** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏–π
2. **Basic Authentication** –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
3. **Autodiscover** –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
4. **MockEwsServer disposal** –ø—Ä–æ–±–ª–µ–º—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ—Å—Ç–∞—Ö

### –°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –≠—Ç–∞–ø 4: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ ICS ‚Üî Exchange
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ IcsParser –∏ ExchangeService
- –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ UID
- Dry-run —Ä–µ–∂–∏–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ 