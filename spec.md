# CalSync - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 17 –¥–µ–∫–∞–±—Ä—è 2024  
**–≠—Ç–∞–ø—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã:** 4 –∏–∑ 6  
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 75% ‚úÖ

### üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–≠—Ç–∞–ø 1-4 –ó–ê–í–ï–†–®–ï–ù** - –ü–æ–ª–Ω–∞—è HttpClient-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Exchange –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π:
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ .ics —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º iCloud –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
- ‚úÖ **–û–ë–ù–û–í–õ–ï–ù–û:** –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ HttpClient –¥–ª—è Exchange
- ‚úÖ **–û–ë–ù–û–í–õ–ï–ù–û:** –£–¥–∞–ª–µ–Ω–∏–µ Microsoft.Graph –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ **–ù–û–í–û–ï:** –ü–æ–ª–Ω—ã–π CRUD —Ü–∏–∫–ª —á–µ—Ä–µ–∑ SOAP/HTTP –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **–ù–û–í–û–ï:** –†–∞–±–æ—Ç–∞ –Ω–∞ .NET 9 —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏
- ‚úÖ **–ù–û–í–û–ï:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (Europe/Moscow ‚Üí UTC)
- ‚úÖ **–ù–û–í–û–ï:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º Exchange —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ
- ‚úÖ 71 —Ç–µ—Å—Ç, 64 —É—Å–ø–µ—à–Ω—ã—Ö (90% success rate)

### üìÅ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **Models/CalendarEvent.cs** - –ú–æ–¥–µ–ª—å —Å ExchangeId –¥–ª—è EWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
2. **Services/IcsDownloader.cs** - HTTP/HTTPS –∑–∞–≥—Ä—É–∑—á–∏–∫
3. **Services/IcsParser.cs** - RFC 5545 –ø–∞—Ä—Å–µ—Ä
4. **Program.cs** - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### **–û–ë–ù–û–í–õ–ï–ù–ù–´–ï Exchange –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
5. **Services/ExchangeHttpService.cs** - –ü–æ–ª–Ω–∞—è HTTP/SOAP —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
   - CreateCalendarEventAsync() - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
   - GetCalendarEventsAsync() - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ 
   - UpdateCalendarEventAsync() - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
   - DeleteCalendarEventAsync() - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
6. **Services/ExchangeService.cs** - Legacy EWS (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

#### **–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
7. **CalSync.Tests/** - –ü–æ–ª–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
8. **MockEwsServer.cs** - HTTP –º–æ–∫-—Å–µ—Ä–≤–µ—Ä –¥–ª—è EWS
9. **EwsRequestRecorder.cs** - –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ EWS –∑–∞–ø—Ä–æ—Å–æ–≤

#### **–§–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
10. **SECURITY.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
11. **appsettings.Local.json.example** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üîÑ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

- **–≠—Ç–∞–ø 5:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (RRULE, –∏—Å–∫–ª—é—á–µ–Ω–∏—è)
- **–≠—Ç–∞–ø 6:** –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ deployment

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–û–ì–û–í–û–†–Å–ù–ù–û–°–¢–ò –ò –ü–û–î–í–û–î–ù–´–ï –ö–ê–ú–ù–ò

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö–†–ò–¢–ò–ß–ù–û!)
- **–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å appsettings.Local.json —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏**
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ –º–æ–∫-–¥–∞–Ω–Ω—ã–µ
- –†–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üö® –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

#### ‚úÖ –†–ï–®–ï–ù–û: UID-based —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ö–†–ò–¢–ò–ß–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ title+time —Å–æ–∑–¥–∞–≤–∞–ª –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è
- **–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ iCloud –∑–∞ –ø—Ä–µ–¥–µ–ª—ã 30-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –æ–∫–Ω–∞, —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –º–æ–≥–ª–∞ –Ω–∞–π—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–æ–∑–¥–∞–≤–∞–ª–∞ –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
- **–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ industry-standard UID-based —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞–¥–µ–∂–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. **ICS ‚Üí Exchange:** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ UID –∏–∑ .ics —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `calendar:UID` Exchange
2. **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `FindItems` —Å `SearchFilter` –ø–æ ICalUid –≤–º–µ—Å—Ç–æ title+time
3. **–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –ø–æ UID ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ; –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
4. **SOAP –∑–∞–ø—Ä–æ—Å—ã:** –î–æ–±–∞–≤–ª–µ–Ω—ã `<t:FieldURI FieldURI="calendar:UID" />` –∏ `<t:UID>` —ç–ª–µ–º–µ–Ω—Ç—ã

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ SOAP –∑–∞–ø—Ä–æ—Å–æ–≤:**
```xml
<!-- GetCalendarEvents -->
<t:FieldURI FieldURI="calendar:UID" />

<!-- CreateEvent -->
<t:UID>{uid-from-ics}</t:UID>
```

#### ‚úÖ –†–ï–®–ï–ù–û: CalSync –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Extended Properties
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö CalSync, –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** Extended Properties —Å –µ–¥–∏–Ω—ã–º PropertySetId –¥–ª—è –≤—Å–µ—Ö CalSync –¥–∞–Ω–Ω—ã—Ö
- **PropertySetId:** `C11FF724-AA03-4555-9952-8FA248A11C3E` (–µ–¥–∏–Ω—ã–π namespace –¥–ª—è CalSync)
- **–°–≤–æ–π—Å—Ç–≤–∞:**
  - `CalSync` (String) = "true" - –º–µ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è CalSync
  - `EventUrl` (String) = URL –∏–∑ ICS - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URL —Å–æ–±—ã—Ç–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Extended Properties:**
```xml
<t:ExtendedProperty>
  <t:ExtendedFieldURI PropertySetId="C11FF724-AA03-4555-9952-8FA248A11C3E" PropertyName="CalSync" PropertyType="String" />
  <t:Value>true</t:Value>
</t:ExtendedProperty>
<t:ExtendedProperty>
  <t:ExtendedFieldURI PropertySetId="C11FF724-AA03-4555-9952-8FA248A11C3E" PropertyName="EventUrl" PropertyType="String" />
  <t:Value>{event-url}</t:Value>
</t:ExtendedProperty>
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–æ–≥–æ PropertySetId:**
- –õ–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö CalSync —Å–≤–æ–π—Å—Ç–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º Microsoft EWS
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

#### ‚úÖ –†–ï–®–ï–ù–û: Exchange –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ HttpClient
- **–ü—Ä–æ–±–ª–µ–º–∞ .NET 9:** Microsoft.Exchange.WebServices –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º
- **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ HttpClient —Å –ø—Ä—è–º—ã–º–∏ SOAP –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ .NET 9, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Timezone –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Europe/Moscow ‚Üí UTC

#### ‚úÖ –†–ï–®–ï–ù–û: –£–¥–∞–ª–µ–Ω–∏–µ GraphService
- **–ü—Ä–æ–±–ª–µ–º–∞:** Azure.Identity/Microsoft.Graph –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ Graph –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–æ–ª—å–∫–æ —Å HttpClient

#### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- **Update/Delete –æ–ø–µ—Ä–∞—Ü–∏–∏:** SOAP —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **FindItem –∑–∞–ø—Ä–æ—Å—ã:** –í–æ–∑–≤—Ä–∞—â–∞—é—Ç ErrorInvalidRequest (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞)
- **–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:** –†–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ ‚úÖ

### üìã –†–∞–±–æ—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Exchange

```json
{
    "Exchange": {
        "ServiceUrl": "https://your-exchange-server.com/EWS/Exchange.asmx",
        "Domain": "your-domain",
        "Username": "your-username", 
        "Password": "your-password",
        "Version": "Exchange2016_SP1",
        "UseAutodiscover": false,
        "RequestTimeout": 30000,
        "MaxBatchSize": 100,
        "ValidateSslCertificate": false
    }
}
```

### üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –†–µ–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
- ‚úÖ **ICS –∑–∞–≥—Ä—É–∑–∫–∞:** 314 —Å–æ–±—ã—Ç–∏–π –∏–∑ iCloud –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** 1 —Å–æ–±—ã—Ç–∏–µ –Ω–∞ 19 –∏—é–Ω—è 2025
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –≤ Exchange:** –°–æ–±—ã—Ç–∏–µ "test" —Å–æ–∑–¥–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã:** 10:15 Moscow ‚Üí 07:15 UTC ‚úÖ
- ‚úÖ **Event ID:** –ü–æ–ª—É—á–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π Exchange ID

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- ‚úÖ **HttpClient –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ
- ‚úÖ **SOAP –∑–∞–ø—Ä–æ—Å—ã:** –§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **SSL –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** Basic Auth —á–µ—Ä–µ–∑ HttpClient

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### FR-001: –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ .ics —Ñ–∞–π–ª–æ–≤ –ø–æ HTTP/HTTPS URL
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ webcal:// –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- ‚úÖ Timeout –∏ retry –º–µ—Ö–∞–Ω–∏–∑–º—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### FR-002: –ü–∞—Ä—Å–∏–Ω–≥ .ics —Ñ–∞–π–ª–æ–≤ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ RFC 5545 (iCalendar)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–±—ã—Ç–∏–π (VEVENT)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (Europe/Moscow)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
- üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è (RRULE) - —á–∞—Å—Ç–∏—á–Ω–æ

### FR-003: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Exchange Server ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ HTTP/SOAP API
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Exchange 2013/2016/2019
- ‚úÖ Basic Authentication —á–µ—Ä–µ–∑ HttpClient
- ‚úÖ SSL/TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã ExchangeHttpService:**
- `TestConnectionAsync()` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚úÖ
- `CreateCalendarEventAsync()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
- `GetCalendarEventsAsync()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π ‚úÖ
- `UpdateCalendarEventAsync()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
- `DeleteCalendarEventAsync()` - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ

### FR-004: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ Exchange
- ‚úÖ **–û–ë–ù–û–í–õ–ï–ù–û:** UID-based —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–≤–º–µ—Å—Ç–æ title+time)
- ‚úÖ **–ù–û–í–û–ï:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ calendar:UID –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **–ù–û–í–û–ï:** CalSync Extended Properties –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ CRUD —Ü–∏–∫–ª–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
- ‚ö†Ô∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ SOAP –∑–∞–ø—Ä–æ—Å–æ–≤

### FR-005: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ Exchange –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Exchange ID

## –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### NFR-001: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ 314 —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è: ~2 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

### NFR-002: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ Graceful handling –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ Proper disposal –ø–∞—Ç—Ç–µ—Ä–Ω

### NFR-003: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ git
- ‚úÖ SECURITY.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### NFR-004: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- ‚úÖ .NET 9.0
- ‚úÖ Windows 10/11, Linux, macOS
- ‚úÖ Exchange Server 2013/2016/2019
- ‚úÖ HttpClient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∏–Ω–∞–ª—å–Ω–∞—è HttpClient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CLI Interface ‚îÇ    ‚îÇ  Configuration  ‚îÇ    ‚îÇ    Logging      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  CalSync Core   ‚îÇ
                    ‚îÇ   (Program.cs)  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  IcsDownloader  ‚îÇ ‚îÇ    IcsParser    ‚îÇ ‚îÇExchangeHttpSrvc ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ   HttpClient    ‚îÇ ‚îÇ RFC 5545 Parser ‚îÇ ‚îÇ  SOAP/HTTP API  ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                ‚îÇ                ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  ICS Calendar   ‚îÇ ‚îÇ CalendarEvent   ‚îÇ ‚îÇ Exchange Server ‚îÇ
   ‚îÇ   (iCloud)      ‚îÇ ‚îÇ     Model       ‚îÇ ‚îÇ     (EWS)       ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **ExchangeHttpService** - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è Exchange
   - –ü—Ä—è–º—ã–µ HTTP/SOAP –∑–∞–ø—Ä–æ—Å—ã
   - Basic Authentication
   - –ü–æ–ª–Ω—ã–π CRUD —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
   - Proper timezone handling

2. **CalendarEvent Model** - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
   - ICS —Å–≤–æ–π—Å—Ç–≤–∞ (Uid, Summary, Start, End)
   - Exchange —Å–≤–æ–π—Å—Ç–≤–∞ (ExchangeId)
   - Timezone –ø–æ–¥–¥–µ—Ä–∂–∫–∞

3. **Program.cs** - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π

### –ü—Ä–∏–Ω—Ü–∏–ø—ã UID-based —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

CalSync –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **industry-standard –ø–æ–¥—Ö–æ–¥** –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏:

#### 1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UID**
```
ICS —Ñ–∞–π–ª ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ UID ‚Üí Exchange calendar:UID –ø–æ–ª–µ
```

- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `UID:` —Å—Ç—Ä–æ–∫–∞ –∏–∑ .ics —Ñ–∞–π–ª–∞
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** `<t:UID>` —ç–ª–µ–º–µ–Ω—Ç –≤ Exchange SOAP –∑–∞–ø—Ä–æ—Å–∞—Ö
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç:** RFC 5545 (iCalendar specification)

#### 2. **–ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
```csharp
// –ù–æ–≤—ã–π UID-based –ø–æ–¥—Ö–æ–¥ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
foreach (var icsEvent in icsEvents)
{
    var existingEvent = await FindExchangeEventByUID(icsEvent.Uid);
    if (existingEvent != null)
    {
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ
        await UpdateExchangeEvent(existingEvent, icsEvent);
    }
    else
    {
        // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
        await CreateExchangeEvent(icsEvent);
    }
}

// –°—Ç–∞—Ä—ã–π title+time –ø–æ–¥—Ö–æ–¥ (–ø—Ä–æ–±–ª–µ–º–Ω—ã–π - –£–î–ê–õ–ï–ù)
// var match = exchangeEvents.FirstOrDefault(e => 
//     e.Summary == icsEvent.Summary && 
//     Math.Abs((e.Start - icsEvent.Start).TotalMinutes) <= 30);
```

#### 3. **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ UID-based –ø–æ–¥—Ö–æ–¥–∞**

| –ê—Å–ø–µ–∫—Ç | Title+Time (—Å—Ç–∞—Ä—ã–π) | UID-based (–Ω–æ–≤—ã–π) |
|--------|-------------------|------------------|
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | ‚ùå –õ–æ–∂–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è | ‚úÖ 100% —Ç–æ—á–Ω–æ—Å—Ç—å |
| **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ** | ‚ùå –°–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** | ‚ùå –°–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚ùå O(n¬≤) —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | ‚úÖ O(1) –ø–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å—É |
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç—å** | ‚ùå –°–∞–º–æ–¥–µ–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º | ‚úÖ RFC 5545 —Å—Ç–∞–Ω–¥–∞—Ä—Ç |

#### 4. **SOAP –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è UID**

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Å UID:**
```xml
<t:AdditionalProperties>
  <t:FieldURI FieldURI="calendar:UID" />
  <!-- –¥—Ä—É–≥–∏–µ –ø–æ–ª—è... -->
</t:AdditionalProperties>
```

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å UID:**
```xml
<t:CalendarItem>
  <t:Subject>{event.Summary}</t:Subject>
  <t:UID>{event.Uid}</t:UID>
  <!-- –¥—Ä—É–≥–∏–µ –ø–æ–ª—è... -->
</t:CalendarItem>
```

**–ü–æ–∏—Å–∫ –ø–æ UID (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è):**
```xml
<m:Restriction>
  <t:IsEqualTo>
    <t:FieldURI FieldURI="calendar:UID" />
    <t:FieldURIOrConstant>
      <t:Constant Value="{target-uid}" />
    </t:FieldURIOrConstant>
  </t:IsEqualTo>
</m:Restriction>
```

### CalSync Extended Properties

#### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –û—Ç–ª–∏—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è CalSync –æ—Ç —Ä—É—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —á—É–∂–∏—Ö —Å–æ–±—ã—Ç–∏–π  
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **URL —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ

#### PropertySetId –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
PropertySetId: C11FF724-AA03-4555-9952-8FA248A11C3E (CalSync namespace)
‚îú‚îÄ‚îÄ PropertyName: "CalSync" ‚Üí Value: "true"
‚îú‚îÄ‚îÄ PropertyName: "EventUrl" ‚Üí Value: "https://..."
‚îî‚îÄ‚îÄ (–±—É–¥—É—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞...)
```

**–ü–æ—á–µ–º—É –µ–¥–∏–Ω—ã–π PropertySetId –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- **Namespace isolation:** –í—Å–µ CalSync –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
- **Microsoft —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ EWS
- **–ö–æ–Ω—Ñ–ª–∏–∫—Ç prevention:** –£–Ω–∏–∫–∞–ª—å–Ω—ã–π GUID –∏—Å–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏—è

```mermaid
graph TD
    A[ICS Event] --> B[Extract UID]
    B --> C[Search Exchange by UID]
    C --> D{Found?}
    D -->|Yes| E[Update existing]
    D -->|No| F[Create new with UID]
    E --> G[Add CalSync metadata]
    F --> G
    G --> H[Save to Exchange]
    H --> I[Log statistics]
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

#### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:
1. **–°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ –≤ ICS:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ Exchange
2. **–°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ Exchange:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ICS (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—å)
3. **UID –∫–æ–ª–ª–∏–∑–∏—è:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏, –ø—Ä–æ–ø—É—Å–∫ —Å–æ–±—ã—Ç–∏—è
4. **Network failures:** Retry —Å exponential backoff

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
- **ICS-first approach:** ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å - –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- **Preserve manual events:** –ù–µ —Ç—Ä–æ–≥–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –±–µ–∑ CalSync –º–µ—Ç–∫–∏
- **Conflict logging:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **Graceful degradation:** –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- .NET 9.0 SDK
- –î–æ—Å—Ç—É–ø –∫ Exchange Server
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ appsettings.Local.json

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/kucheruk/calsync.git
cd calsync

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp calsync/appsettings.Local.json.example calsync/appsettings.Local.json
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ appsettings.Local.json —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
dotnet build
cd calsync
dotnet run

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
cd ../CalSync.Tests
dotnet test
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
CalSync - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π ICS ‚Üî Exchange
================================================
üìÖ ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å: https://p67-caldav.icloud.com/published/2/...
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ICS —Å–æ–±—ã—Ç–∏–π: 314
üìÖ –í —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ: 1
‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å ID: AAMkADBkMDhiZDQ4LWZj...

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
  ‚úÖ –°–æ–∑–¥–∞–Ω–æ: 1
  ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ: 0
  ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ: 0
  ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0
  ‚ùå –û—à–∏–±–æ–∫: 0
```

## Roadmap

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (–≠—Ç–∞–ø—ã 1-4)
- –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ICS –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥
- Exchange HttpClient –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ü–æ–ª–Ω—ã–π CRUD —Ü–∏–∫–ª
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã
- –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üîÑ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–≠—Ç–∞–ø 5)
- –î–æ—Ä–∞–±–æ—Ç–∫–∞ Update/Delete SOAP –∑–∞–ø—Ä–æ—Å–æ–≤
- –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–æ–≤ Exchange
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ RRULE

### üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è (–≠—Ç–∞–ø 6)
- PowerShell –º–æ–¥—É–ª—å
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- CI/CD pipeline
- Production deployment 