# –û—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 17 –¥–µ–∫–∞–±—Ä—è 2024, 14:58  
**–í–µ—Ä—Å–∏—è .NET**: 8.0 (–º–∏–≥—Ä–∞—Ü–∏—è —Å 9.0)  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

## üéØ –ó–∞–¥–∞—á–∞
- –ó–∞–≥—Ä—É–∑–∏—Ç—å ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `IcsUrl`
- –ù–∞–π—Ç–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞ 19 –∏—é–Ω—è 2025 –≥–æ–¥–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å Exchange
- –ó–∞–ø–∏—Å–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è mock-—Ç–µ—Å—Ç–æ–≤

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚úÖ ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
- **URL**: https://p67-caldav.icloud.com/published/2/MTY5NzA0MzY4MTE2OTcwNIHLdGt1OhB_Gz7VZgyPXPqSFlhnT1CPCBiih9hy2wKB
- **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**: 119,940 —Å–∏–º–≤–æ–ª–æ–≤
- **–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π**: 314
- **–°–æ–±—ã—Ç–∏—è –≤ —Ü–µ–ª–µ–≤–æ–º –ø–µ—Ä–∏–æ–¥–µ (2025-06-19)**: 1

### üéØ –ù–∞–π–¥–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ 19 –∏—é–Ω—è 2025
```json
{
  "Summary": "test",
  "Start": "2025-06-19 10:15:00",
  "End": "2025-06-19 11:15:00",
  "Location": "",
  "Description": "",
  "Uid": "0B46436C-9A48-449A-BAC3-1749CB982D12"
}
```

### üîÑ –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–†–µ–∂–∏–º**: –û—Ç–ª–∞–¥–æ—á–Ω—ã–π (–±–µ–∑ Exchange –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ Microsoft.Exchange.WebServices —Å .NET 8
- **–û—à–∏–±–∫–∞ Exchange**: `malloc: Double free of object` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é

## üß™ Mock-–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **–§–∞–π–ª**: `CalSync.Tests/TestHelpers/mock_ics_events_2025-06-19.json`
- **–§–æ—Ä–º–∞—Ç**: JSON —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ unit-—Ç–µ—Å—Ç–∞—Ö
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**: 1 —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ 19 –∏—é–Ω—è 2025

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ .NET 8
- ‚úÖ `calsync.csproj`: –∏–∑–º–µ–Ω–µ–Ω TargetFramework —Å net9.0 –Ω–∞ net8.0
- ‚úÖ `CalSync.Tests.csproj`: –∏–∑–º–µ–Ω–µ–Ω TargetFramework —Å net9.0 –Ω–∞ net8.0
- ‚úÖ –ü–∞–∫–µ—Ç—ã Microsoft.Extensions.Configuration –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–æ –≤–µ—Ä—Å–∏–π 8.x

### –î–æ–±–∞–≤–ª–µ–Ω –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ä–µ–∂–∏–º
- ‚úÖ –ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
  - `CalSync:SkipExchangeConnection: true`
  - `CalSync:DebugMode: true`
  - `CalSync:Sync:DryRun: true`
- ‚úÖ –ú–µ—Ç–æ–¥ `ProcessIcsOnlyAsync()` –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ Exchange

## ‚ö†Ô∏è –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Microsoft.Exchange.WebServices —Å .NET 8
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è .NET Framework
- **–°–∏–º–ø—Ç–æ–º**: `malloc: Double free of object` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ä–µ–∂–∏–º —Å –ø—Ä–æ–ø—É—Å–∫–æ–º Exchange –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
- NU1701: –ü–∞–∫–µ—Ç Microsoft.Exchange.WebServices –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è .NET Framework
- CS8600, CS1998: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ ExchangeService.cs

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω —Å–æ–±—ã—Ç–∏–π
- **–°–∞–º–æ–µ —Ä–∞–Ω–Ω–µ–µ**: 2007-01-30 (–ü–æ–ø–∏–Ω–∞—Ç—å –î–∏–º—É –æ–± —ç–∫–∑–∞–º–µ–Ω–∞—Ö)
- **–°–∞–º–æ–µ –ø–æ–∑–¥–Ω–µ–µ**: 2025-06-19 (test)
- **–ü–µ—Ä–∏–æ–¥—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**:
  - 2007-2013: –ª–∏—á–Ω—ã–µ –∏ —Ä–∞–±–æ—á–∏–µ —Å–æ–±—ã—Ç–∏—è
  - 2024: —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
  - 2025: –µ–¥–∏–Ω–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π
- –†–∞–±–æ—á–∏–µ –≤—Å—Ç—Ä–µ—á–∏ –∏ –∑–∞–¥–∞—á–∏
- –õ–∏—á–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)
- –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –≥–æ–¥–æ–≤—â–∏–Ω—ã
- –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –±–∏–ª–µ—Ç—ã

## üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç–µ

### 1. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã Exchange
- –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è Exchange
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Microsoft Graph API –≤–º–µ—Å—Ç–æ EWS
- –í–æ–∑–º–æ–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—Ç –∫ .NET Framework –¥–ª—è Exchange —á–∞—Å—Ç–∏

### 2. –£–ª—É—á—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ mock-–¥–∞–Ω–Ω—ã–µ –≤ unit-—Ç–µ—Å—Ç–∞—Ö
- –†–∞—Å—à–∏—Ä–∏—Ç—å coverage —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ICS –ø–∞—Ä—Å–µ—Ä–∞
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å mock Exchange Server

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–±–∞–≤–∏—Ç—å structured logging
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—à–∏–±–∫–∏

## ‚úÖ –í—ã–≤–æ–¥—ã
1. **ICS –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –ø–∞—Ä—Å–∏—Ç—Å—è**
2. **–°–æ–±—ã—Ç–∏–µ –Ω–∞ 19 –∏—é–Ω—è 2025 –Ω–∞–π–¥–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
3. **Mock-–¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ—Å—Ç–æ–≤**
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å Exchange —Ç—Ä–µ–±—É—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è**
5. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ .NET 8 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ** 